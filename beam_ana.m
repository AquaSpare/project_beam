% Provides analytical solution to the problem
% utt = -a1*uxxxx, -1 < x < 0,
% vtt = -a2*vxxxx, 0 < x < 1.
% where a1 = 1 and a2 = 4 or a1 = 1 and a2 = 100.
%
% Boundary conditions: 
%
% Clamped: BC = 1;
% u = ux = 0, at x = -1;
% v = vx = 0, at x = 1;
%
% Free: BC = 2
% uxx = uxxx = 0, at x = -1;
% vxx = vxxx = 0, at x = 1; 
%
% Sliding: BC = 3
% ux = uxxx = 0, at x = -1;
% vx = vxxx = 0, at x = 1; 
%
% Hinged: BC = 4
% u = uxx = 0, at x = -1;
% v = vxx = 0, at x = 1; 
%
% Coupling conditions:
% u = v, ux = vx, a1*uxx = a2*vxx, a1*uxxx = a2*vxxx, at x = 0.
%
% Initial conditions:
% u = X1, v = X2, ut = 0, vt = 0, at t = 0
%
function [u,v] = beam_ana(BC, a1, a2)
if(BC == 1) %clamped
    if(a1 == 1 && a2 == 100)
        params = [-5.794825217627827;
                  -1.832484633028485;
                   0.705361665776949;
                  -3.269062483338326;
                  -0.657333265501956;
                 -10.669915996531302;
                  -3.425155276425828;
                  -4.681978546303924;
                  -5.162995494465162;
                  -6.164253767568096];
    elseif(a1 == 1 && a2 == 4)
        params = [-2.724541243866793;
                  -1.926541589160640;
                  -0.006419236351027;
                  -0.451983247217049;
                  -0.111158417686709;
                  -1.184543127678100;
                  -0.166608837875750;
                  -0.481670171411734;
                  -0.379504595184558;
                  -0.916196950180250];
    end
elseif(BC == 2) %free
    if(a1 == 1 && a2 == 100)
        params = [-5.325826562636521
                  -1.684174236095682
                  -3.577946854229812
                   1.726844562360710
                   3.507558302154236
                 -10.085343659539857
                  -3.765610881558936
                  -2.088088542705270
                  -2.609247580608103
                  -3.968537776777517];
    elseif(a1 == 1 && a2 == 4)
        params = [2.636119548107137
                 -1.864018008484659
                  0.657391643019733
                  1.303791900283099
                  1.168077713674310
                 -4.870048619066272
                 -1.158229179985459
                 -1.615303185257100
                 -0.341453869508962
                 -3.360517035880276];
    end
elseif(BC == 3)
    if(a1 == 1 && a2 == 100)
        params = [-6.951345438836244
                   2.198208438934520
                   1.497306173096465
                  -3.931533818784467
                  -1.497308917696529
                  -4.981266884993619
                   2.990476880514045
                   4.707226823209424
                  -3.065090002980266
                  -3.413485799709968];
    elseif(a1 == 1 && a2 == 4) 
          params = [-3.581693437902900
                    -2.532639718072511
                    -0.055746399769286
                    -0.588685799070706
                     0.055832809746495
                    -1.250119410207789
                    -0.267259846210958
                    -0.644104909418392
                    -0.270655245241869
                    -0.923631355218945];
    end
elseif(BC == 4)
    if(a1 == 1 && a2 == 100)
        params = [-4.443390090101463
                   1.405123321734142
                   0.380673484053980
                  -0.275150641473418
                  -0.380568277447727
                   0.998077475489175
                  -0.270541162922727
                  -0.063151364807251
                   0.239822311373879
                   0.377686886667569];
    elseif(a1 == 1 && a2 == 4)
        params = [-1.759149252318507
                  -1.243906365433650
                  -0.488749482484439
                  -0.774812374459543
                   0.460601380035878
                  -4.064858565724649
                  -0.792334652114624
                  -0.994611662872776
                  -0.670763606404561
                  -2.933493579284087];
    end
else
    return;
end
b1 = params(1);
b2 = params(2);
A1 = params(3);
A2 = params(4);
A3 = params(5);
A4 = params(6);
A5 = params(7);
A6 = params(8);
A7 = params(9);
A8 = params(10);

T1 = @(t) cos(sqrt(a1)*b1^2*t);
X1 = @(x) A1*sinh(b1*x) + A2*sin(b1*x) + A3*cosh(b1*x) + A4*cos(b1*x);
T2 = @(t) cos(sqrt(a2)*b2^2*t);
X2 = @(x) A5*sinh(b2*x) + A6*sin(b2*x) + A7*cosh(b2*x) + A8*cos(b2*x);
u = @(x,t) T1(t)*X1(x);
v = @(x,t) T2(t)*X2(x);
