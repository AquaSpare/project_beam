function [D4, H, HI, M, e1, eN, d1_1, dN_1, d1_2, dN_2, d1_3, dN_3] = SBP4_D4(N, h)

H=diag(ones(N,1),0);
H_U=[0.35809e5 / 0.100800e6 0 0 0 0 0; 0 0.13297e5 / 0.11200e5 0 0 0 0; 0 0 0.5701e4 / 0.5600e4 0 0 0; 0 0 0 0.45109e5 / 0.50400e5 0 0; 0 0 0 0 0.35191e5 / 0.33600e5 0; 0 0 0 0 0 0.33503e5 / 0.33600e5;];

H(1:6,1:6)=H_U;
H(N-5:N,N-5:N)=rot90(H_U,2);
H=H*h;
HI=inv(H);  

e1=zeros(1,N);e1(1)=1;
eN=zeros(1,N);eN(N)=1;

d1_U=[-0.11e2 / 0.6e1 3 -0.3e1 / 0.2e1 0.1e1 / 0.3e1;]/h;
d1_1=zeros(1,N);
d1_1(1:4)=d1_U;
dN_1=zeros(1,N);
dN_1(N-3:N)=fliplr(-d1_U);

d2_U=[2 -5 4 -1;]/h^2;
d1_2=zeros(1,N);
d1_2(1:4)=d2_U;
dN_2=zeros(1,N);
dN_2(N-3:N)=fliplr(d2_U);

m3=-1/6;m2=2;m1=-13/2;m0=28/3;
M=m3*(diag(ones(N-3,1),3)+diag(ones(N-3,1),-3))+m2*(diag(ones(N-2,1),2)+diag(ones(N-2,1),-2))+m1*(diag(ones(N-1,1),1)+diag(ones(N-1,1),-1))+m0*diag(ones(N,1),0);
M4_U=[0.4596181e7 / 0.1814400e7 -0.10307743e8 / 0.1814400e7 0.160961e6 / 0.43200e5 -0.535019e6 / 0.907200e6 0.109057e6 / 0.1814400e7 -0.29273e5 / 0.604800e6; -0.10307743e8 / 0.1814400e7 0.8368543e7 / 0.604800e6 -0.9558943e7 / 0.907200e6 0.2177057e7 / 0.907200e6 -0.11351e5 / 0.86400e5 0.204257e6 / 0.1814400e7; 0.160961e6 / 0.43200e5 -0.9558943e7 / 0.907200e6 0.4938581e7 / 0.453600e6 -0.786473e6 / 0.151200e6 0.1141057e7 / 0.907200e6 -0.120619e6 / 0.907200e6; -0.535019e6 / 0.907200e6 0.2177057e7 / 0.907200e6 -0.786473e6 / 0.151200e6 0.3146581e7 / 0.453600e6 -0.4614143e7 / 0.907200e6 0.24587e5 / 0.14400e5; 0.109057e6 / 0.1814400e7 -0.11351e5 / 0.86400e5 0.1141057e7 / 0.907200e6 -0.4614143e7 / 0.907200e6 0.185709e6 / 0.22400e5 -0.11293343e8 / 0.1814400e7; -0.29273e5 / 0.604800e6 0.204257e6 / 0.1814400e7 -0.120619e6 / 0.907200e6 0.24587e5 / 0.14400e5 -0.11293343e8 / 0.1814400e7 0.16787381e8 / 0.1814400e7;];
M(1:6,1:6)=M4_U;
M(N-5:N,N-5:N)=rot90(M4_U, 2);
M=M/h^3;
    
d3_U=[-1 3 -3 1;]/h^3;
d1_3=zeros(1,N);
d1_3(1:4)=d3_U;
dN_3=zeros(1,N);
dN_3(N-3:N)=fliplr(-d3_U);

D4=HI*(M-e1'*d1_3+eN'*dN_3  + d1_1'*d1_2-dN_1'*dN_2);
